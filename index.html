<!DOCTYPE html>
<html>

  <head>
    <title>GRACQ Hesbaye - Custom Cycle Map Style</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css" integrity="sha256-kLaT2GOSpHechhsozzB+flnD+zUyjE2LlfWPgU04xyI=" crossorigin="" />
    <script src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js" integrity="sha256-WBkoXOwTeyKclOHuWtc+i2uENFpDZ9YPdf5Hf+D7ewM=" crossorigin="">
    </script>
    <script src='https://api.mapbox.com/mapbox-gl-js/v3.0.1/mapbox-gl.js'></script>
    <link href='https://api.mapbox.com/mapbox-gl-js/v3.0.1/mapbox-gl.css' rel='stylesheet' />
  </head>
  <style>
    body {
      padding: 0;
      margin: 0;
      overflow: hidden;
    }
    html,
    body {
      height: 100%;
      width: 100%;
    }
  </style>

  <body>
    <div id='map' style='width: 100%; height: 100%;'></div>
    <script>
      mapboxgl.accessToken = 'pk.eyJ1IjoidHRvb2ZmIiwiYSI6ImNscXd4bmppMDA4bnAya3B6enB5MDNhaGsifQ.5MU53sF5b8x2yVpTmBoNyw';
      const map = new mapboxgl.Map({
	      container: 'map', // container ID
        style: 'mapbox://styles/ttooff/clqxqzle900xr01r557np76rd', // style URL
        center: [5.2538, 50.6958], // starting position [lng, lat]
        zoom: 13, // starting zoom
      });

// Initialize a pop-up instance
const popup = new mapboxgl.Popup({ closeButton: false });

map.on('mousemove', function(e) {
  const features = map.queryRenderedFeatures(e.point);

  // Filter features to only include those with a non-transparent line color
  const nonTransparentLineFeatures = features.filter(feature => {
    const lineColor = feature.layer.paint['line-color'];
    const layerName = feature.layer.id;

    // Exclude layers with specific names
    const excludeLayers = ['Highways - case', 'Highways - line', 'road-rail-tracks', 'road-rail'];
    const isExcluded = excludeLayers.includes(layerName);

    return lineColor && lineColor != 'transparent' && lineColor != 'rgba(0,0,0,0)' && !isExcluded;
  });

  // Extract information for the first layer with a non-transparent line color
  const firstNonTransparentLineFeature = nonTransparentLineFeatures[0];

  // Close the pop-up
  popup.remove();

  // Display pop-up for the first layer
  if (firstNonTransparentLineFeature) {
    const layerName = firstNonTransparentLineFeature.layer.id;
    const lineColor = firstNonTransparentLineFeature.layer.paint['line-color'];

    // Set pop-up content
    popup.setLngLat(e.lngLat)
      .setHTML(`<div><strong>${layerName}</strong></div>`)
      .addTo(map);
  }
});

    </script>
  </body>

</html>
